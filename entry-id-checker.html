<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Forms Entry ID æª¢æŸ¥å™¨</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-container { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .result { background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 10px 0; }
        .error { background: #ffe8e8; }
        code { background: #f0f0f0; padding: 2px 6px; border-radius: 4px; }
        button { background: #1a73e8; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        button:hover { background: #1557b0; }
    </style>
</head>
<body>
    <h1>ğŸ” Google Forms Entry ID æª¢æŸ¥å™¨</h1>
    
    <div class="form-container">
        <h2>æ­¥é©Ÿ 1ï¼šæª¢æŸ¥ç•¶å‰è¡¨å–®</h2>
        <p>é»æ“ŠæŒ‰éˆ•ä¾†æª¢æŸ¥è¡¨å–® ID: <code>1EcP0lRyBuZP8LUPHdlgrZYzBoHANATrVwgK7QEpou0A</code></p>
        <button onclick="checkFormStructure()">æª¢æŸ¥è¡¨å–®çµæ§‹</button>
        <div id="formCheck"></div>
    </div>

    <div class="form-container">
        <h2>æ­¥é©Ÿ 2ï¼šæ¸¬è©¦ç•¶å‰ Entry IDs</h2>
        <p>ä½¿ç”¨ç•¶å‰é…ç½®çš„ Entry IDs é€²è¡Œæ¸¬è©¦æäº¤ï¼š</p>
        <ul>
            <li>name: <code>entry.1623417871</code></li>
            <li>email: <code>entry.1144033944</code></li>
            <li>phone: <code>entry.1623219296</code></li>
            <li>service: <code>entry.153606403</code></li>
            <li>subject: <code>entry.716883917</code></li>
            <li>message: <code>entry.1025881327</code></li>
        </ul>
        
        <form id="testForm">
            <div style="margin: 10px 0;">
                <label>å§“å: <input type="text" name="name" value="æ¸¬è©¦ç”¨æˆ¶" required></label>
            </div>
            <div style="margin: 10px 0;">
                <label>é›»å­éƒµä»¶: <input type="email" name="email" value="test@example.com" required></label>
            </div>
            <div style="margin: 10px 0;">
                <label>è¯çµ¡é›»è©±: <input type="tel" name="phone" value="0912345678"></label>
            </div>
            <div style="margin: 10px 0;">
                <label>æœå‹™é¡å‹: 
                    <select name="service" required>
                        <option value="å…¶ä»–è«®è©¢">å…¶ä»–è«®è©¢</option>
                        <option value="æ©Ÿå ´æ¥é€">æ©Ÿå ´æ¥é€</option>
                        <option value="æ—…éŠåŒ…è»Š">æ—…éŠåŒ…è»Š</option>
                        <option value="éœ²ç‡Ÿè»Šå‡ºç§Ÿ">éœ²ç‡Ÿè»Šå‡ºç§Ÿ</option>
                        <option value="è²¨è»Šå‡ºç§Ÿ">è²¨è»Šå‡ºç§Ÿ</option>
                    </select>
                </label>
            </div>
            <div style="margin: 10px 0;">
                <label>ä¸»æ—¨: <input type="text" name="subject" value="Entry ID æ¸¬è©¦"></label>
            </div>
            <div style="margin: 10px 0;">
                <label>è¨Šæ¯: <textarea name="message" rows="3">é€™æ˜¯ä¸€å€‹ Entry ID æ­£ç¢ºæ€§æ¸¬è©¦</textarea></label>
            </div>
            <button type="submit">æ¸¬è©¦æäº¤</button>
        </form>
        <div id="testResult"></div>
    </div>

    <div class="form-container">
        <h2>æ­¥é©Ÿ 3ï¼šè¨ºæ–·è³‡è¨Š</h2>
        <div id="diagnostics"></div>
    </div>

    <script>
        const GOOGLE_FORM_CONFIG = {
            formId: '1EcP0lRyBuZP8LUPHdlgrZYzBoHANATrVwgK7QEpou0A',
            sheetId: '1AySXECv5cjF79YmeXY7uFwrM69-JQFG1B4MP6KD6hUU',
            actionUrl: 'https://docs.google.com/forms/d/e/1EcP0lRyBuZP8LUPHdlgrZYzBoHANATrVwgK7QEpou0A/formResponse',
            fields: {
                name: 'entry.1623417871',
                email: 'entry.1144033944',
                phone: 'entry.1623219296',
                service: 'entry.153606403',
                subject: 'entry.716883917',
                message: 'entry.1025881327'
            }
        };

        function checkFormStructure() {
            const checkDiv = document.getElementById('formCheck');
            checkDiv.innerHTML = '<p>ğŸ” æª¢æŸ¥ä¸­...</p>';
            
            const formUrl = `https://docs.google.com/forms/d/e/${GOOGLE_FORM_CONFIG.formId}/viewform`;
            
            checkDiv.innerHTML = `
                <div class="result">
                    <h3>âœ… è¡¨å–®è³‡è¨Š</h3>
                    <p><strong>è¡¨å–® ID:</strong> <code>${GOOGLE_FORM_CONFIG.formId}</code></p>
                    <p><strong>é è¦½ç¶²å€:</strong> <a href="${formUrl}" target="_blank">${formUrl}</a></p>
                    <p><strong>æäº¤ç¶²å€:</strong> <code>${GOOGLE_FORM_CONFIG.actionUrl}</code></p>
                    
                    <h4>ğŸ“‹ æª¢æŸ¥æ­¥é©Ÿ:</h4>
                    <ol>
                        <li>é»æ“Šä¸Šæ–¹é è¦½ç¶²å€é–‹å•Ÿè¡¨å–®</li>
                        <li>æŒ‰ F12 é–‹å•Ÿé–‹ç™¼è€…å·¥å…·</li>
                        <li>æª¢æŸ¥æ¯å€‹è¼¸å…¥æ¬„ä½çš„ <code>name</code> å±¬æ€§</li>
                        <li>ç¢ºèªæ˜¯å¦èˆ‡ä¸‹æ–¹é…ç½®ç›¸ç¬¦</li>
                    </ol>
                    
                    <h4>ğŸ”§ ç•¶å‰é…ç½®:</h4>
                    <pre>${JSON.stringify(GOOGLE_FORM_CONFIG.fields, null, 2)}</pre>
                </div>
            `;
        }

        function createGoogleFormData(originalFormData) {
            const googleFormData = new FormData();
            
            for (const [originalField, googleField] of Object.entries(GOOGLE_FORM_CONFIG.fields)) {
                const value = originalFormData.get(originalField);
                if (value && value.trim()) {
                    googleFormData.append(googleField, value.trim());
                    console.log(`âœ… æ˜ å°„: ${originalField} -> ${googleField} = ${value.trim()}`);
                }
            }
            
            googleFormData.append('submit', 'Submit');
            googleFormData.append('usp', 'pp_url');
            
            return googleFormData;
        }

        async function submitToGoogleForm(formData) {
            const submitData = new URLSearchParams();
            
            for (const [key, value] of formData.entries()) {
                submitData.append(key, value);
                console.log(`ğŸ“ æäº¤æ¬„ä½: ${key} = ${value}`);
            }
            
            try {
                const response = await fetch(GOOGLE_FORM_CONFIG.actionUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: submitData
                });
                
                console.log('âœ… è¡¨å–®æäº¤å®Œæˆ (no-cors æ¨¡å¼)');
                return true;
            } catch (error) {
                console.error('âŒ æäº¤å¤±æ•—:', error);
                throw error;
            }
        }

        document.getElementById('testForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const resultDiv = document.getElementById('testResult');
            resultDiv.innerHTML = '<p>ğŸ“¤ æäº¤ä¸­...</p>';
            
            try {
                const formData = new FormData(this);
                
                console.log('ğŸš€ é–‹å§‹æ¸¬è©¦æäº¤...');
                console.log('ğŸ“ åŸå§‹è¡¨å–®è³‡æ–™:');
                for (const [key, value] of formData.entries()) {
                    console.log(`  ${key}: ${value}`);
                }
                
                const googleFormData = createGoogleFormData(formData);
                
                console.log('ğŸ“¤ Google è¡¨å–®è³‡æ–™:');
                for (const [key, value] of googleFormData.entries()) {
                    console.log(`  ${key}: ${value}`);
                }
                
                await submitToGoogleForm(googleFormData);
                
                resultDiv.innerHTML = `
                    <div class="result">
                        <h3>âœ… æ¸¬è©¦æäº¤å®Œæˆ</h3>
                        <p>è«‹æª¢æŸ¥ä»¥ä¸‹ä½ç½®ï¼š</p>
                        <ol>
                            <li><strong>Google Sheets:</strong> ç¢ºèªæ˜¯å¦æœ‰æ–°çš„è³‡æ–™è¡Œ</li>
                            <li><strong>Apps Script æ—¥èªŒ:</strong> æª¢æŸ¥æ˜¯å¦æœ‰è§¸ç™¼å™¨åŸ·è¡Œè¨˜éŒ„</li>
                            <li><strong>é›»å­éƒµä»¶:</strong> æª¢æŸ¥ rayterter@hotmail.com æ˜¯å¦æ”¶åˆ°éƒµä»¶</li>
                        </ol>
                        <p><strong>æ™‚é–“æˆ³è¨˜:</strong> ${new Date().toLocaleString('zh-TW')}</p>
                    </div>
                `;
                
                updateDiagnostics();
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <h3>âŒ æ¸¬è©¦æäº¤å¤±æ•—</h3>
                        <p><strong>éŒ¯èª¤:</strong> ${error.message}</p>
                        <p>è«‹æª¢æŸ¥ Entry IDs æ˜¯å¦æ­£ç¢ºï¼Œæˆ–è¡¨å–®æ˜¯å¦å¯æ­£å¸¸å­˜å–ã€‚</p>
                    </div>
                `;
            }
        });

        function updateDiagnostics() {
            const diagnosticsDiv = document.getElementById('diagnostics');
            diagnosticsDiv.innerHTML = `
                <div class="result">
                    <h3>ğŸ” è¨ºæ–·æª¢æŸ¥æ¸…å–®</h3>
                    <h4>1. Google Forms æª¢æŸ¥</h4>
                    <ul>
                        <li>âœ… è¡¨å–® ID: ${GOOGLE_FORM_CONFIG.formId}</li>
                        <li>â“ Entry IDs æ˜¯å¦æ­£ç¢ºï¼ˆéœ€æ‰‹å‹•é©—è­‰ï¼‰</li>
                        <li>â“ è¡¨å–®æ˜¯å¦é€£æ¥åˆ° Google Sheets</li>
                    </ul>
                    
                    <h4>2. Apps Script æª¢æŸ¥</h4>
                    <ul>
                        <li>â“ è§¸ç™¼å™¨æ˜¯å¦è¨­ç½®ç‚ºã€Œè¡¨å–®æäº¤æ™‚ã€</li>
                        <li>â“ è§¸ç™¼å™¨äº‹ä»¶ä¾†æºæ˜¯å¦ç‚ºæ­£ç¢ºçš„è©¦ç®—è¡¨</li>
                        <li>â“ Apps Script æ¬Šé™æ˜¯å¦å·²æˆæ¬Š</li>
                    </ul>
                    
                    <h4>3. éƒµä»¶ç³»çµ±æª¢æŸ¥</h4>
                    <ul>
                        <li>âœ… æ¸¬è©¦å‡½æ•¸å¯ä»¥ç™¼é€éƒµä»¶</li>
                        <li>â“ å¯¦éš›è¡¨å–®æäº¤æ˜¯å¦è§¸ç™¼éƒµä»¶</li>
                        <li>â“ æ”¶ä»¶äººä¿¡ç®±æ˜¯å¦æ­£ç¢º</li>
                    </ul>
                    
                    <h4>ğŸ“Š æª¢æŸ¥å»ºè­°</h4>
                    <ol>
                        <li>åœ¨ Google Sheets ä¸­æª¢æŸ¥ã€Œè¡¨å–®å›æ‡‰ã€åˆ†é æ˜¯å¦æœ‰æ–°è³‡æ–™</li>
                        <li>åœ¨ Apps Script ä¸­æŸ¥çœ‹ã€ŒåŸ·è¡Œã€è¨˜éŒ„æ˜¯å¦æœ‰è§¸ç™¼</li>
                        <li>æª¢æŸ¥ Apps Script çš„ã€Œè§¸ç™¼å™¨ã€è¨­ç½®</li>
                        <li>ç¢ºèªç¶²ç«™è¡¨å–®å’Œ Apps Script ä½¿ç”¨ç›¸åŒçš„ Google å¸³è™Ÿ</li>
                    </ol>
                </div>
            `;
        }

        // é é¢è¼‰å…¥æ™‚æ›´æ–°è¨ºæ–·è³‡è¨Š
        updateDiagnostics();
    </script>
</body>
</html>